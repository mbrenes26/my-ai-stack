
# 1.2.5 Combining DataFrames in Pandas

## Context
This lesson explains how to combine multiple DataFrames using Pandas methods such as concatenation, merging, and joining. These techniques are essential for integrating data from different sources in data analysis workflows.

## Overview
Combining DataFrames allows you to unify data stored across different tables or files.  
This section covers how to concatenate, merge, and join DataFrames efficiently using Pandas.

## Key Concepts
- **Concatenation** appends DataFrames vertically or horizontally.
- **Merging** combines DataFrames based on shared column values.
- **Joining** merges DataFrames based on index labels.
- Each method supports different use cases depending on data structure.

---

## Worked Examples

### [00:04] Combining Multiple DataFrames
Combining multiple DataFrames is crucial when data is spread across different files or tables.

Three primary methods:
1. **Concatenation** – Append DataFrames along rows or columns.
2. **Merging** – Combine DataFrames based on common column values.
3. **Joining** – Combine DataFrames based on index labels.

---

### [00:24] Creating DataFrames for Analysis
Example setup:

```python
import pandas as pd

df1 = pd.DataFrame({
    'CustomerID': [1, 2, 3],
    'Category': ['A', 'B', 'C'],
    'FirstVisit': [True, False, True],
    'Sales': [100, 200, 300]
})

df2 = pd.DataFrame({
    'CustomerID': [2, 3, 4],
    'Distance': [5.0, 7.2, 3.5],
    'Sales': [250, 300, 400]
})
```

---

### [01:03] Concatenation of DataFrames
Concatenation appends DataFrames along a specified axis.

```python
# Vertical stacking (rows)
pd.concat([df1, df2], axis=0)

# Horizontal stacking (columns)
pd.concat([df1, df2], axis=1)
```

- `axis=0` → stack vertically.
- `axis=1` → align side by side.

NOTE: May result in duplicate columns if not handled carefully.

---

### [03:07] Merging DataFrames
Merging combines DataFrames based on **common column values**.

```python
pd.merge(df1, df2, on='CustomerID', how='inner')
```

Merge types:
- **outer** – all rows from both DataFrames.
- **inner** – only matching rows.
- **left** – all rows from left DataFrame.
- **right** – all rows from right DataFrame.

---

### [05:49] Understanding Merge Types
| Merge Type  | Description |
|-------------|-------------|
| **Outer**   | Includes all rows from both DataFrames. Missing values filled with NaN. |
| **Inner**   | Includes only rows with matching keys in both DataFrames. |
| **Left**    | All rows from left DataFrame; matching rows from right. |
| **Right**   | All rows from right DataFrame; matching rows from left. |

Example:
```python
pd.merge(df1, df2, on='CustomerID', how='outer')
```

---

### [07:16] Joining DataFrames Using Indexes
Joining is similar to merging but uses **index labels**.

```python
df1.set_index('CustomerID', inplace=True)
df2.set_index('CustomerID', inplace=True)

df1.join(df2, how='inner')
```

This method is efficient when DataFrames have established indexes.

---

## Formulas (plain text)
- Concatenate: `pd.concat([df1, df2], axis)`
- Merge: `pd.merge(df1, df2, on='key', how='type')`
- Join: `df1.join(df2, how='type')`

---

## Summary
- **Concatenation** stacks DataFrames vertically or horizontally.
- **Merging** combines DataFrames based on common columns.
- **Joining** merges DataFrames using index labels.
- Choose the method based on data alignment and structure.

---

## References
- [Pandas Documentation – Combining DataFrames](https://pandas.pydata.org/docs/user_guide/merging.html)

---

### Private Video Reference

> Access: Use your own Azure credentials or a short-lived SAS.  
> We do not publish proprietary media in this repository.
