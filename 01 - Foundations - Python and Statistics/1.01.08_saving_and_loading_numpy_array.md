# 1.1.8 Saving and Loading NumPy Array

This section explains how to **save and load data** using **NumPy** in Python.  
Efficient data management is essential for **data analysis** and **machine learning** workflows, allowing you to preserve results, avoid recomputation, and maintain reproducibility.

Topics covered:
- Why saving and loading data is important
- Using Google Drive with Google Colab
- Creating and saving random matrices
- Avoiding file save errors and managing directories
- Saving multiple arrays into one file
- Loading saved arrays into Python
- Saving and loading text files

---

## [00:05] Importance of Saving and Loading Data

Saving data allows you to:
- Pause and resume work without rerunning all code.
- Avoid the cost of regenerating large datasets.
- Maintain reproducibility across sessions.

Example:
```python
import numpy as np

np.save('my_data.npy', my_array)  # Save NumPy array
loaded_array = np.load('my_data.npy')  # Load it back
```

---

## [00:38] Using Google Drive with Google Colab

Google Colab can mount Google Drive so you can **read and write files** directly.

Example:
```python
from google.colab import drive
drive.mount('/content/drive')
```
Once mounted, Google Drive works like a **local filesystem**, which is ideal for collaboration.

---

## [03:03] Creating and Saving Random Matrices

Generate a random matrix and save it:
```python
matrix = np.random.randint(0, 100, (5, 5))  # 5×5 random integers
np.save('random_matrix.npy', matrix)        # Save to file
```

---

## [03:56] Handling File Save Errors and Directory Management

⚠ **Important:** Python will not create missing directories automatically.  
You must ensure the save path exists:
```python
import os

save_dir = '/content/data'
os.makedirs(save_dir, exist_ok=True)  # Create if not exists
np.save(f'{save_dir}/matrix.npy', matrix)
```

---

## [05:45] Saving Multiple Files with `np.savez()`

`np.savez()` lets you save **multiple arrays** in one file:
```python
np.savez('multiple_arrays.npz', arr1=matrix, arr2=matrix * 2)
```
Load and access them:
```python
data = np.load('multiple_arrays.npz')
print(data['arr1'])
print(data['arr2'])
```

---

## [07:52] Loading Data with `np.load()`

Load a saved array:
```python
loaded_matrix = np.load('random_matrix.npy')
```
For `.npz` files:
```python
data = np.load('multiple_arrays.npz')
arr1 = data['arr1']
```

---

## [09:52] Saving and Loading Text Files

Use `np.savetxt()` and `np.loadtxt()` for text formats (e.g., Excel-friendly):
```python
np.savetxt('matrix.txt', matrix, fmt='%d')  # Save
loaded_text = np.loadtxt('matrix.txt', dtype=int)  # Load
```
Advantages:
- Works across platforms.
- Readable by many programs.

⚠ Note: Saving to text may cause **data type changes** (e.g., int → float). Use `dtype` to preserve types.

---

## Summary

- Saving and loading arrays improves **efficiency** and **reproducibility**.
- Use `np.save()` and `np.load()` for binary `.npy` files.
- Use `np.savez()` to store multiple arrays in one file.
- Use `np.savetxt()` and `np.loadtxt()` for text-based interoperability.
- Always ensure directories exist before saving files.

---
